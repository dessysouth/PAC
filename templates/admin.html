<!DOCTYPE html>
<html lang="en">
  <head>
    <title>PAC || Admin</title>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <link
      href="https://fonts.googleapis.com/css?family=Muli:300,400,700,900"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/bootstrap.min.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/jquery-ui.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/owl.carousel.min.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/owl.theme.default.min.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/jquery.fancybox.min.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/bootstrap-datepicker.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='fonts/flaticon/font/flaticon.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/jquery.mb.YTPlayer.min.css') }}"
      media="all"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/style.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='fonts/icomoon/style.css') }}"
    />
  </head>

  <body data-spy="scroll" data-target=".site-navbar-target" data-offset="300">
    <div class="site-wrap">
      <!-- Mobile Menu -->
      <div class="site-mobile-menu site-navbar-target">
        <div class="site-mobile-menu-header">
          <div class="site-mobile-menu-close mt-3">
            <span class="icon-close2 js-menu-toggle"></span>
          </div>
        </div>
        <div class="site-mobile-menu-body"></div>
      </div>
      <div
        class="site-logo"
        style="margin-left: 30px; margin-top: 10px; position: fixed"
      >
        <a href="{{ url_for('home') }}" class="d-block">
          <img
            style="width: 100px"
            src="{{ url_for('static', filename='images/WhatsApp_Image_2024-03-08_at_08.55.48_e7c7c63c.png') }}"
            alt="Image"
            class="img-fluid"
          />
        </a>
      </div>

      <div class="site-section">
        <div class="container">
          <div class="row mb-5 justify-content-center text-center">
            <div class="col-lg-4 mt-5">
              <h2 class="section-title-underline">
                <span>Admin Page</span>
              </h2>
            </div>
          </div>
          <!-- Tabs Navigation -->
          <ul class="nav nav-tabs" id="adminTabs" role="tablist">
            <li class="nav-item">
              <a
                class="nav-link active"
                id="courses-tab"
                data-toggle="tab"
                href="#courses"
                role="tab"
                aria-controls="courses"
                aria-selected="true"
                >Courses</a
              >
            </li>
            <li class="nav-item">
              <a
                class="nav-link"
                id="instructors-tab"
                data-toggle="tab"
                href="#instructors"
                role="tab"
                aria-controls="instructors"
                aria-selected="false"
                >Instructors</a
              >
            </li>
            <li class="nav-item">
              <a
                class="nav-link"
                id="students-tab"
                data-toggle="tab"
                href="#students"
                role="tab"
                aria-controls="students"
                aria-selected="false"
                >Students</a
              >
            </li>
            <li class="nav-item">
              <a
                class="nav-link"
                id="cart-tab"
                data-toggle="tab"
                href="#cart"
                role="tab"
                aria-controls="cart"
                aria-selected="false"
                >Cart Items</a
              >
            </li>
            <li class="nav-item">
              <a
                class="nav-link"
                id="payments-tab"
                data-toggle="tab"
                href="#payments"
                role="tab"
                aria-controls="payments"
                aria-selected="false"
                >Payments</a
              >
            </li>
          </ul>
          <!-- Tab Contents -->
          <div class="tab-content" id="adminTabsContent">
            <!-- Courses Tab -->
            <div
              class="tab-pane fade show active"
              id="courses"
              role="tabpanel"
              aria-labelledby="courses-tab"
            >
              <section>
                <table class="table">
                  <thead>
                    <tr>
                      <th>ID</th>
                      <th>Title</th>
                      <th>Category</th>
                      <th>Instructor</th>
                      <th>Price</th>
                      <th>Duration</th>
                      <th>Materials</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody>
                    {% for course in courses %}
                    <tr>
                      <td>{{ course.id }}</td>
                      <td>{{ course.title }}</td>
                      <td>{{ course.category }}</td>
                      <td>
                        {% if course.instructor %} {{ course.instructor.fullname
                        }} {% else %} No Instructor {% endif %}
                      </td>
                      <td>{{ course.price }}</td>
                      <td>{{ course.duration }}</td>
                      <td>
                        <a
                          href="{{ url_for('admin.upload_material', course_id=course.id) }}"
                          class="btn btn-secondary"
                          >Upload Material</a
                        >
                      </td>
                      <td>
                        <a
                          href="{{ url_for('admin.edit_course', course_id=course.id) }}"
                          class="btn btn-primary"
                          >Edit</a
                        >
                        <form
                          action="{{ url_for('admin.delete_course', course_id=course.id) }}"
                          method="POST"
                          style="display: inline-block"
                        >
                          <button
                            type="submit"
                            class="btn btn-danger"
                            onclick="return confirm('Are you sure you want to delete this course?');"
                          >
                            Delete
                          </button>
                        </form>
                      </td>
                    </tr>
                    {% endfor %}
                  </tbody>
                </table>
              </section>
            </div>

            <!-- Instructors Tab -->
            <div
              class="tab-pane fade"
              id="instructors"
              role="tabpanel"
              aria-labelledby="instructors-tab"
            >
              <section>
                <table class="table">
                  <thead>
                    <tr>
                      <th>ID</th>
                      <th>Profile Image</th>
                      <th>Full Name</th>
                      <th>Email</th>
                      <th>Phone Number</th>
                      <th>House Address</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody>
                    {% for instructor in instructors %}
                    <tr>
                      <td>{{ instructor.id }}</td>
                      <td>
                        {% if instructor.profile_image %}
                        <img
                          src="{{ url_for('static', filename='profile_images/' + instructor.profile_image) }}"
                          alt="Profile Image"
                          width="50"
                        />
                        {% else %} No Image {% endif %}
                      </td>
                      <td>{{ instructor.fullname }}</td>
                      <td>{{ instructor.email }}</td>
                      <td>{{ instructor.phone_number }}</td>
                      <td>{{ instructor.house_address }}</td>

                      <td>
                        <a
                          href="{{ url_for('admin.edit_instructor', instructor_id=instructor.id) }}"
                          class="btn btn-primary"
                          >Edit</a
                        >
                        <form
                          action="{{ url_for('admin.delete_instructor', instructor_id=instructor.id) }}"
                          method="POST"
                          style="display: inline-block"
                        >
                          <button
                            type="submit"
                            class="btn btn-danger"
                            onclick="return confirm('Are you sure you want to delete this instructor?');"
                          >
                            Delete
                          </button>
                        </form>
                      </td>
                    </tr>
                    {% endfor %}
                  </tbody>
                </table>
              </section>
            </div>
            <!-- Students Tab -->
            <div
              class="tab-pane fade"
              id="students"
              role="tabpanel"
              aria-labelledby="students-tab"
            >
              <section>
                <table class="table">
                  <thead>
                    <tr>
                      <th>ID</th>
                      <th>Profile Image</th>
                      <th>First Name</th>
                      <th>Last Name</th>
                      <th>Email</th>
                      <th>Phone Number</th>
                      <th>House Address</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody>
                    {% for student in students %}
                    <tr>
                      <td>{{ student.id }}</td>
                      <td>
                        {% if student.profile_image %}
                        <img
                          src="{{ url_for('static', filename='uploads/' + student.profile_image) }}"
                          alt="{{ student.firstname }}"
                          width="50"
                          style="border-radius: 100px"
                        />
                        {% else %} No Image {% endif %}
                      </td>
                      <td>{{ student.firstname }}</td>
                      <td>{{ student.lastname }}</td>
                      <td>{{ student.user.email }}</td>
                      <td>{{ student.phone_number }}</td>
                      <td>{{ student.house_address }}</td>
                      <td>
                        <form
                          action="{{ url_for('admin.delete_student', student_id=student.id) }}"
                          method="POST"
                          style="display: inline-block"
                        >
                          <button
                            type="submit"
                            class="btn btn-danger"
                            onclick="return confirm('Are you sure you want to delete this student?');"
                          >
                            Delete
                          </button>
                        </form>
                      </td>
                    </tr>
                    {% endfor %}
                  </tbody>
                </table>
              </section>
            </div>
            <!-- Cart Items Tab -->
            <div
              class="tab-pane fade"
              id="cart"
              role="tabpanel"
              aria-labelledby="cart-tab"
            >
              <section>
                <table class="table">
                  <thead>
                    <tr>
                      <th>ID</th>
                      <th>Course Title</th>
                      <th>Category</th>
                      <th>Price</th>
                      <th>User Email</th>
                      <th>User Phone</th>
                      <th>Date Added</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody>
                    {% for item in cart_items %}
                    <tr>
                      <td>{{ item.id }}</td>
                      <td>{{ item.course.title }}</td>
                      <td>{{ item.course.category }}</td>
                      <td>#{{ item.course.price }}</td>
                      <td>{{ item.user.email }}</td>
                      <td>{{ item.user.student_profile.phone_number }}</td>
                      <td>{{ item.date_added.strftime('%Y-%m-%d') }}</td>
                      <td>
                        <form
                          action="{{ url_for('admin.admin_remove_from_cart', cart_id=item.id) }}"
                          method="POST"
                          style="display: inline-block"
                        >
                          <button type="submit" class="btn btn-danger">
                            Remove
                          </button>
                        </form>
                      </td>
                    </tr>
                    {% endfor %}
                  </tbody>
                </table>
              </section>
            </div>
            <!-- Payments Tab -->
            <div
              class="tab-pane fade"
              id="payments"
              role="tabpanel"
              aria-labelledby="payments-tab"
            >
              <section>
                <table class="table">
                  <thead>
                    <tr>
                      <th>ID</th>
                      <th>User</th>
                      <th>Course</th>
                      <th>Amount</th>
                      <th>Reference</th>
                      <th>Status</th>
                      <th>Timestamp</th>
                    </tr>
                  </thead>
                  <tbody>
                    {% for payment in payments %}
                    <tr>
                      <td>{{ payment.id }}</td>
                      <td>{{ payment.student.user.username }}</td>
                      <td>{{ payment.course.title }}</td>
                      <td># {{ payment.amount }}</td>
                      <td>{{ payment.reference }}</td>
                      <td>{{ payment.status }}</td>
                      <td>{{ payment.timestamp }}</td>
                    </tr>
                    {% endfor %}
                  </tbody>
                </table>
              </section>
            </div>
          </div>

          <div style="display: flex">
            <div class="row justify-content-center" style="margin-left: 1rem">
              <div class="">
                <a
                  href="{{ url_for('admin.create_instructor') }}"
                  class="btn btn-primary btn-block rounded-0 px-4"
                  >Create Instructor Profile</a
                >
              </div>
            </div>

            <div class="row justify-content-center" style="margin-left: 43rem">
              <div class="">
                <a
                  href="{{ url_for('admin.add_course') }}"
                  class="btn btn-primary btn-block rounded-0 px-4"
                  >Add New Course</a
                >
              </div>
            </div>
          </div>
        </div>
      </div>

      <div id="loader" class="show fullscreen">
        <svg class="circular" width="68px" height="68px">
          <circle
            class="path-bg"
            cx="24"
            cy="24"
            r="22"
            fill="none"
            stroke-width="4"
            stroke="#eeeeee"
          />
          <circle
            class="path"
            cx="24"
            cy="24"
            r="22"
            fill="none"
            stroke-width="4"
            stroke-miterlimit="10"
            stroke="#51be78"
          />
        </svg>
      </div>
      <a href="#" id="back-to-top" class="back-to-top">
        <span>&uarr;</span>
      </a>
      <script src="{{ url_for('static', filename='js/jquery-3.3.1.min.js') }}"></script>
      <script src="{{ url_for('static', filename='js/jquery-migrate-3.0.1.min.js') }}"></script>
      <script src="{{ url_for('static', filename='js/jquery-ui.js') }}"></script>
      <script src="{{ url_for('static', filename='js/popper.min.js') }}"></script>
      <script src="{{ url_for('static', filename='js/bootstrap.min.js') }}"></script>
      <script src="{{ url_for('static', filename='js/owl.carousel.min.js') }}"></script>
      <script src="{{ url_for('static', filename='js/jquery.stellar.min.js') }}"></script>
      <script src="{{ url_for('static', filename='js/jquery.countdown.min.js') }}"></script>
      <script src="{{ url_for('static', filename='js/bootstrap-datepicker.min.js') }}"></script>
      <script src="{{ url_for('static', filename='js/jquery.easing.1.3.js') }}"></script>
      <script src="{{ url_for('static', filename='js/jquery.fancybox.min.js') }}"></script>
      <script src="{{ url_for('static', filename='js/jquery.sticky.js') }}"></script>
      <script src="{{ url_for('static', filename='js/jquery.mb.YTPlayer.min.js') }}"></script>
      <script src="{{ url_for('static', filename='js/main.js') }}"></script>
      <script>
        $(document).ready(function () {
          $("#adminTabs a").on("click", function (e) {
            e.preventDefault();
            $(this).tab("show");
          });
        });
      </script>
    </div>
  </body>
</html>
